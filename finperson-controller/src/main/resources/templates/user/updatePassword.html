<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
<head>
<title>Spring Security Example</title>
</head>
<body>
	<div sec:authorize="hasAuthority('CHANGE_PASSWORD_PRIVILEGE')">
	    <h1 th:text="#{user.message.resetPassword}">reset</h1>
	    
	    <form th:action="@{/user/updatePassword}" th:object="${user}" method="post">
	    
	    	<input type="hidden" th:field="*{id}" />
	    	<input type="hidden" th:field="*{token}" />
	    	
	    	<input type="hidden" th:field="*{firstName}" />
	    	<input type="hidden" th:field="*{lastName}" />
	    	
	    	<div>
	    		<label th:text="*{email}">email</label>
	    		<input type="hidden" th:field="*{email}" />
	    	</div>
	    	<div>
		        <label th:text="#{user.resetPass.password}">password</label>
		        <input type="password" th:field="*{password}" />
		 		<p th:each="error : ${#fields.errors('password')}" th:text="${error}">Validation
					error</p>
			</div>
			<div>	
	        	<label th:text="#{user.resetPass.confirmPass}">confirm</label>
	        	<input type="password" th:field="*{matchingPassword}" />
	        </div>
	
	        <button type="submit" th:text="#{user.resetpassword.submit}">submit</button>
	    </form>

	</div> 
</body>
</html>